#!/bin/bash
set -x 
curl -sfL https://get.k3s.io | sh -
sudo ufw allow 6443/tcp
sudo ufw reload
mkdir -p ~/.kube
touch ~/.kube/config
chown $(id -u):$(id -g) ~/.kube/config
chmod 600 ~/.kube/config

kubectl apply -f https://raw.githubusercontent.com/metallb/metallb/v0.12.1/manifests/namespace.yaml
kubectl apply -f https://raw.githubusercontent.com/metallb/metallb/v0.12.1/manifests/metallb.yaml
echo -e "apiVersion: v1\nkind: ConfigMap\nmetadata:\n  namespace: metallb-system\n  name: config\ndata:\n  config: |\n    address-pools:\n    - name: default\n      protocol: layer2\n      addresses:\n      - 103.228.200.17-103.228.200.18" >> metallb-configmap.yaml
chmod +x metallb-configmap.yaml
kubectl apply -f metallb-configmap.yaml

curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3
chmod 700 get_helm.sh
./get_helm.sh
curl https://baltocdn.com/helm/signing.asc | gpg --dearmor | sudo tee /usr/share/keyrings/helm.gpg > /dev/null
sudo apt-get install apt-transport-https --yes
echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/helm.gpg] https://baltocdn.com/helm/stable/debian/ all main" | sudo tee /etc/apt/sources.list.d/helm-stable-debian.list
sudo apt-get update
sudo apt-get install helm
helm -n production repo add ingress-nginx https://kubernetes.github.io/ingress-nginx
helm -n production repo add  stable https://charts.helm.sh/stable
helm repo add nginx-stable https://helm.nginx.com/stable
helm -n production  repo update

export KUBECONFIG=/etc/rancher/k3s/k3s.yaml
kubectl create namespace production
kubectl run nginx --image=nginx --namespace=production
kubectl config set-context --current --namespace=production
helm -n production install ibosio-ingress nginx-stable/nginx-ingress --set controller.service.type=LoadBalancer,controller.ingressClass=ibosio-ingress
kubectl -n production get all 	
kubectl get svc

echo -e "-----BEGIN CERTIFICATE-----
MIIGLjCCBRagAwIBAgIRAItafYlZhzNeUKOrh2+EBAkwDQYJKoZIhvcNAQELBQAw
gY8xCzAJBgNVBAYTAkdCMRswGQYDVQQIExJHcmVhdGVyIE1hbmNoZXN0ZXIxEDAO
BgNVBAcTB1NhbGZvcmQxGDAWBgNVBAoTD1NlY3RpZ28gTGltaXRlZDE3MDUGA1UE
AxMuU2VjdGlnbyBSU0EgRG9tYWluIFZhbGlkYXRpb24gU2VjdXJlIFNlcnZlciBD
QTAeFw0yMjA2MTIwMDAwMDBaFw0yMzA3MTMyMzU5NTlaMBcxFTATBgNVBAMMDCou
cnNjLWJkLm9yZzCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANKxbm+e
XyTEELoRa2zKrGoa5eIfhbQU3fLVx99HNOxQ65O9WFfJYI4f++3URy/h/X3e7Xge
NfpX1reX8F4vTFwIEhVc38THCLuVLMwnRojsrpfgmi7XPStpCmtIo5v/pm3za7/m
dbd5kqUvKqVDXn6dgAw/PRR1vqF3ND6x/2rckrtfL7wvajWp9DL5IPaNxtRSzn2k
lCFKJSzkqws/VnWus19mpVdWJLQmQsdWv6zCSi/xAH7z4jGFiR1708owuVnSk7mp
4v57nHDANvgBICGWiGWEmA5U1zdXJmH4iIERbCT6W+gMgYLIXWuDn34BUyb7CyNA
WXIv6jKk7GHuDm8CAwEAAaOCAvowggL2MB8GA1UdIwQYMBaAFI2MXsRUrYrhd+mb
+ZsF4bgBjWHhMB0GA1UdDgQWBBS8h5W1elAEeHRlnkPhOZ+dbtJo+zAOBgNVHQ8B
Af8EBAMCBaAwDAYDVR0TAQH/BAIwADAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYB
BQUHAwIwSQYDVR0gBEIwQDA0BgsrBgEEAbIxAQICBzAlMCMGCCsGAQUFBwIBFhdo
dHRwczovL3NlY3RpZ28uY29tL0NQUzAIBgZngQwBAgEwgYQGCCsGAQUFBwEBBHgw
djBPBggrBgEFBQcwAoZDaHR0cDovL2NydC5zZWN0aWdvLmNvbS9TZWN0aWdvUlNB
RG9tYWluVmFsaWRhdGlvblNlY3VyZVNlcnZlckNBLmNydDAjBggrBgEFBQcwAYYX
aHR0cDovL29jc3Auc2VjdGlnby5jb20wIwYDVR0RBBwwGoIMKi5yc2MtYmQub3Jn
ggpyc2MtYmQub3JnMIIBfgYKKwYBBAHWeQIEAgSCAW4EggFqAWgAdgCt9776fP8Q
yIudPZwePhhqtGcpXc+xDCTKhYY069yCigAAAYFYEb/QAAAEAwBHMEUCIQDnBw+O
GblYdAPaL/Hvls4fjScS60q4iFQ+znSM5k7GSQIgE724y8PpEjBCv+OA8/Jys8uj
kacF0BWPbmT7zbR0AroAdwB6MoxU2LcttiDqOOBSHumEFnAyE4VNO9IrwTpXo1Lr
UgAAAYFYEb+dAAAEAwBIMEYCIQCAXpqKZnp9o6i6jFEVbJfPBnTsNvD1/lrKcQkT
/J5hFQIhAPQu0cCqZCsT/vtKvxOqClnAdY1LCHHx0kNr73MdbcYUAHUA6D7Q2j71
BjUy51covIlryQPTy9ERa+zraeF3fW0GvW4AAAGBWBG/aQAABAMARjBEAiBxgkSB
+2INlLpmXg1EOmbwf6K8nwBy/9nSzaSiYeeXswIgP7lqTUYdhlDWxD++VIWFRpAv
OY1REeQUrXwqEPYLBP4wDQYJKoZIhvcNAQELBQADggEBAJduJbq/JvrKYLT6/YuP
SiSZTD8YIbE2luEeeb1dSxp26YBYMGr1SrVMxdSmC2viDyMnVhy4GwqaLba9Y3eo
mPLb/RYy1CSowVXqsp2RSPmEwEZ+3R/GAI+O8ZMcUtCXK1nw3kR0xOsnCy5N2YTi
TgGGSaO7h+orbX29Ja612xo9QDhzhs9YV0jQZJXU6Z3XjHDtwsMZA9HOThvUv8ZI
mMmtcfvpALjxSVdWQFTn8AxGl6QrNnMKFjTi9iKPwfLgbs4rnqHFmjmSloDF2l0F
c4AB2AYkY+AtILtfe5Bbt4T+pnP66HTFUycfZDEM2fv2rUNFthsj4uVPqjt6xBi8
2KM=
-----END CERTIFICATE-----" >> cert.pem


echo -e "-----BEGIN RSA PRIVATE KEY-----
MIIEowIBAAKCAQEA0rFub55fJMQQuhFrbMqsahrl4h+FtBTd8tXH30c07FDrk71Y
V8lgjh/77dRHL+H9fd7teB41+lfWt5fwXi9MXAgSFVzfxMcIu5UszCdGiOyul+Ca
Ltc9K2kKa0ijm/+mbfNrv+Z1t3mSpS8qpUNefp2ADD89FHW+oXc0PrH/atySu18v
vC9qNan0Mvkg9o3G1FLOfaSUIUolLOSrCz9Wda6zX2alV1YktCZCx1a/rMJKL/EA
fvPiMYWJHXvTyjC5WdKTuani/nuccMA2+AEgIZaIZYSYDlTXN1cmYfiIgRFsJPpb
6AyBgshda4OffgFTJvsLI0BZci/qMqTsYe4ObwIDAQABAoIBAFUMqK7H+FIoDzR9
Cac93QFr4DY6UUeTUNDQuUEJRnTKaX4W5c1yDdbxVEn58c6DZEdmMOfXEiT/Rj6Q
R8hNQX65B0u2VOHjEkRegFnc1N065XOLh9G2swuN+FW8WccEGNOzemBZkFVC7w5d
DtLtcfycaW8ILAjRSuV08BMK2TbyHSiRqvQewh06pkceWzFuVR6VgydWXQulk34a
943sOG9hv6lE0O2o6zJY5nha2ibpajNeFgV/lVIJb1UB8vTpXixnTgH6atHRfnZC
SVs0zvoyUB1eMYMnNDS1o5eL4DQCtcF1snGb+0e9D9x8sFrpHPNZWG2SvsL5qqmb
nlC4A0kCgYEA98IIAlB+V/UF0nT5q+aPqDQt7tJHQUgzAKUzOIo+CmZhn0pbBBqN
o7KYdCRJCrYavPIdMv1LpMEBzM8sNtO6cWkV6moe1zJ1kXYbV+W1W5Mwvmjx8zYY
ieaqEsJdW3RnFVU/IY1w5Dxb50u0GvUXFPdIhKjoHMjqhfhfY2LI2Y0CgYEA2bO/
IV2MBrVMIEES5RzAU++YHgwtD8mhacy7lQqhfkRUBqaPiFMg4jUBLQWlvnfpbivf
xOrggLJvdYaC3KMzGpFqbvxgZIV3ihsQU45e1E9ep3j3GZyDVgPzPYM4NDiZVFyQ
MjP+R7mh6Qpt4VbcrWg3fKCxM8pQL0YBwm9YQusCgYAE7+7s7OG3qwBUs1QOYufV
+EQ6ECKvYFrz1lbw94BJAMVNQVQS/tx3uKVlGxwBhKN/xGtkirupKtd4V2CQLyP2
ApwXMcovi6fgIDRnSgKVMpe0E69Oo3NVvC0DdrAZlHZBbJN3fbQUOEe0kkOijePJ
3SuqyRrnB/H0fYCZIGzUOQKBgF7IED3BkbZV9ofQbR6NDvs8RDlIydGm0nzSoxS3
pSnpK8Adgj4zGw0BULq+S7QKVvodZfZA4G+HwFklsBHJh/VYPEOH45vANBRPxiLq
yESdLbOySbq/1rp7S8qLN8wcnD0Lc8g3tMybeG+Sl9ZU0A07Y3UCLUREH/cE/r0d
ZwrzAoGBAJyyXuNp91WIwxO6J2u8bysU3M7IBTNNuioZ4EAFEiN/hD3petdMvtw0
2aq6m1U9Rj0gwOAnmuEZpdBW/1EtPv+6KG/1iHyBgMihdyT0Mhc5Svb/qjpoZDnt
yZnv2nxIjsc+h6jRaLI3atWj0qqh94+vyY5GWhpQRgKYRd/k8pz+
-----END RSA PRIVATE KEY-----" >> key.pem
chmod 444 key.pem cert.pem
kubectl -n production create secret tls ibosio-ingress-tls --key key.pem --cert cert.pem

echo -e 'apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  annotations:\n    nginx.ingress.kubernetes.io/ssl-redirect: "true"\n    nginx.ingress.kubernetes.io/proxy-read-timeout: "3600"\n    nginx.ingress.kubernetes.io/proxy-send-timeout: "3600"\n    nginx.ingress.kubernetes.io/proxy-body-size: "0"\n    nginx.org/websocket-services: "madina-socket-api,madina-front,mgm-socket-api,sme-front"\n    \n  name: ing-ibosapp\nspec:\n  ingressClassName: ibosio-ingress\n  rules:\n    #madina.ibos.io\n    - host: dev-madina.ibos.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: madina-front\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /domain\n            backend:\n              service:\n                name: madina-domain-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /identity\n            backend:\n              service:\n                name: madina-identity-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /partner\n            backend:\n              service:\n                name: madina-partner-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /procurement\n            backend:\n              service:\n                name: madina-procurement-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /wms\n            backend:\n              service:\n                name: madina-wms-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /hcm\n            backend:\n              service:\n                name: madina-hcm-api\n                port:\n                  number: 80\n\n          - pathType: Prefix\n            path: /costmgmt\n            backend:\n              service:\n                name: madina-cost-api\n                port:\n                  number: 80\n\n          - pathType: Prefix\n            path: /item\n            backend:\n              service:\n                name: madina-item-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /fino\n            backend:\n              service:\n                name: madina-finance-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /oms\n            backend:\n              service:\n                name: madina-oms-api\n                port:\n                  number: 80\n\n          - pathType: Prefix\n            path: /imp\n            backend:\n              service:\n                name: madina-import-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /mes\n            backend:\n              service:\n                name: madina-mes-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /asset\n            backend:\n              service:\n                name: madina-asset-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /tms\n            backend:\n              service:\n                name: madina-tms-api\n                port:\n                  number: 80\n    #madina.ibos.io\n\n    #madina-socket.ibos.io\n    - host: dev-madina-socket.ibos.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: madina-socket-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /socket\n            backend:\n              service:\n                name: madina-socket-api\n                port:\n                  number: 80\n    #madina-socket.ibos.io\n\n    #uat-madina.ibos.io\n    - host: dev-uat-madina.ibos.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: madina-front\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /domain\n            backend:\n              service:\n                name: madina-domain-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /identity\n            backend:\n              service:\n                name: madina-identity-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /partner\n            backend:\n              service:\n                name: madina-partner-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /procurement\n            backend:\n              service:\n                name: madina-procurement-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /wms\n            backend:\n              service:\n                name: madina-wms-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /hcm\n            backend:\n              service:\n                name: madina-hcm-api\n                port:\n                  number: 80\n\n          - pathType: Prefix\n            path: /costmgmt\n            backend:\n              service:\n                name: madina-cost-api\n                port:\n                  number: 80\n\n          - pathType: Prefix\n            path: /item\n            backend:\n              service:\n                name: madina-item-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /fino\n            backend:\n              service:\n                name: madina-finance-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /oms\n            backend:\n              service:\n                name: madina-oms-api\n                port:\n                  number: 80\n\n          - pathType: Prefix\n            path: /imp\n            backend:\n              service:\n                name: madina-import-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /mes\n            backend:\n              service:\n                name: madina-mes-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /asset\n            backend:\n              service:\n                name: madina-asset-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /tms\n            backend:\n              service:\n                name: madina-tms-api\n                port:\n                  number: 80\n    #uat-madina.ibos.io\n\n    #uat-madina-socket.ibos.io\n    - host: dev-uat-madina-socket.ibos.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: madina-socket-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /socket\n            backend:\n              service:\n                name: madina-socket-api\n                port:\n                  number: 80\n    #madina-socket.ibos.io\n    #devshipping.ibos.io\n    - host: dev-shipping.ibos.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: employee-mgmt-front\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /emp\n            backend:\n              service:\n                name: employee-mgmt-api\n                port:\n                  number: 80\n    #devshipping.ibos.io\n    #devhr.peopledesk.io\n    - host: dev-hr.peopledesk.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: peopledesk-saas-front\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /api\n            backend:\n              service:\n                name: peopledesk-saas-api\n                port:\n                  number: 80\n    #devhr.peopledesk.io\n    #devuttara.peopledesk.io\n    - host: dev-uttara.peopledesk.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: people-desk-uttara-front\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /api\n            backend:\n              service:\n                name: people-desk-uttara-api\n                port:\n                  number: 80\n    #devuttara.peopledesk.io\n    #devibos.peopledesk.io\n    - host: dev-ibos.peopledesk.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: employee-mgmt-front\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /emp\n            backend:\n              service:\n                name: employee-mgmt-api\n                port:\n                  number: 80\n    #devibos.peopledesk.io\n    #devhire.peopledesk.io\n    - host: dev-hire.peopledesk.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: hire-desk-front\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /api\n            backend:\n              service:\n                name: hire-desk-api\n                port:\n                  number: 80\n    #devhire.peopledesk.io\n    \n    \n    #devrsc.peopledesk.io\n    - host: dev-rsc.peopledesk.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: people-desk-rsc-front\n                port:\n                  number: 80\n\n          - pathType: Prefix\n            path: /api\n            backend:\n              service:\n                name: people-desk-rsc-api\n                port:\n                  number: 80\n\n    #devarl.peopledesk.io\n    - host: dev-arl.peopledesk.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: people-desk-arl-front\n                port:\n                  number: 80\n\n          - pathType: Prefix\n            path: /api\n            backend:\n              service:\n                name: people-desk-arl-api\n                port:\n                  number: 80\n\n    #devifarmer.peopledesk.io\n    - host: dev-ifarmer.peopledesk.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: people-desk-ifarmer-front\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /api\n            backend:\n              service:\n                name: people-desk-ifarmer-api\n                port:\n                  number: 80\n\n    #devifarmer.peopledesk.io\n    - host: dev-justiceandcarebd.peopledesk.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: people-desk-jncare-front\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /api\n            backend:\n              service:\n                name: people-desk-jncare-api\n                port:\n                  number: 80\n    #dev-apon.ibos.io\n    - host: dev-apon.ibos.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: apon-front\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /apon\n            backend:\n              service:\n                name: apon-api\n                port:\n                  number: 80\n    #dev-apon.ibos.io\n    - host: dev-promotion.ibos.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /promotion\n            backend:\n              service:\n                name: promotion-api\n                port:\n                  number: 80\n    #vat.ibos.io\n    - host: dev-primevat.ibos.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: tax-front\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /domain\n            backend:\n              service:\n                name: tax-domain-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /vat\n            backend:\n              service:\n                name: tax-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /identity\n            backend:\n              service:\n                name: tax-identity-api\n                port:\n                  number: 80\n    #arlvat.ibos.io\n    - host: dev-arlvat.ibos.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: arlvat-front\n                port:\n                  number: 80\n    #devmgm.ibos.io\n    - host: dev-mgm.ibos.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: sme-front\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /sme\n            backend:\n              service:\n                name: sme-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /identity\n            backend:\n              service:\n                name: sme-identity-api\n                port:\n                  number: 80\n\n    #mgm-socket.ibos.io\n    - host: dev-mgm-socket.ibos.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: mgm-socket-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /socket\n            backend:\n              service:\n                name: mgm-socket-api\n                port:\n                  number: 80\n          \n    #cpanel.ibos.io\n    - host: dev-panel.ibos.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: cpanel-front\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /cpanel\n            backend:\n              service:\n                name: cpanel-api\n                port:\n                  number: 80\n    #dev-dealer.ibos.io\n    - host: dev-dealer.ibos.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: dealer-front\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /dealer\n            backend:\n              service:\n                name: dealer-api\n                port:\n                  number: 80\n                  \n    #dev-dealer.ibos.io\n    - host: dev-sscorporation.ibos.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: sscorporation-front\n                port:\n                  number: 80\n\n    #devErp.ibos.io\n    - host: dev-erp.ibos.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: ibos-front\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /costmgmt\n            backend:\n              service:\n                name: cost-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /domain\n            backend:\n              service:\n                name: domain-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /procurement\n            backend:\n              service:\n                name: procurement-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /item\n            backend:\n              service:\n                name: item-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /partner\n            backend:\n              service:\n                name: partner-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /wms\n            backend:\n              service:\n                name: wms-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /mes\n            backend:\n              service:\n                name: mes-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /tms\n            backend:\n              service:\n                name: tms-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /oms\n            backend:\n              service:\n                name: oms-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /pms\n            backend:\n              service:\n                name: pms-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /fino\n            backend:\n              service:\n                name: finance-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /vat\n            backend:\n              service:\n                name: vat-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /hcm\n            backend:\n              service:\n                name: hcm-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /asset\n            backend:\n              service:\n                name: asset-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /rtm\n            backend:\n              service:\n                name: rtm-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /identity\n            backend:\n              service:\n                name: ibos-identity-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /imp\n            backend:\n              service:\n                name: import-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /arlerp\n            backend:\n              service:\n                name: arlerp-api\n                port:\n                  number: 80\n\n    #devrtm.ibos.io\n    - host: dev-rtm.ibos.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: rtm-front\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /domain\n            backend:\n              service:\n                name: domain-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /item\n            backend:\n              service:\n                name: item-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /partner\n            backend:\n              service:\n                name: partner-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /tms\n            backend:\n              service:\n                name: tms-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /oms\n            backend:\n              service:\n                name: oms-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /hcm\n            backend:\n              service:\n                name: hcm-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /rtm\n            backend:\n              service:\n                name: rtm-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /identity\n            backend:\n              service:\n                name: ibos-identity-api\n                port:\n                  number: 80\n    #signal.ibos.io\n    - host: dev-signal.ibos.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: signalr-api\n                port:\n                  number: 80\n\n    #auth.ibos.io\n    - host: dev-auth.ibos.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: identityserver-api\n                port:\n                  number: 80\n\n    #rmg.ibos.io\n    - host: dev-rmg.ibos.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: rmg-front\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /rmg\n            backend:\n              service:\n                name: rmg-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /identity\n            backend:\n              service:\n                name: rmg-identity-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /hr\n            backend:\n              service:\n                name: rmg-hr-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /hrm\n            backend:\n              service:\n                name: rmg-hrm-front\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /finance\n            backend:\n              service:\n                name: rmg-finance-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /production\n            backend:\n              service:\n                name: rmg-production-api\n                port:\n                  number: 80\n    #RMG\n    #rmghr.ibos.io\n    - host: dev-rmghr.ibos.io\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: rmghr-front\n                port:\n                  number: 80\n\n    #erp.akijresources.com\n    - host: dev-erp.akijresources.com\n      http:\n        paths:\n          - pathType: Prefix\n            path: /\n            backend:\n              service:\n                name: ibos-front\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /costmgmt\n            backend:\n              service:\n                name: cost-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /domain\n            backend:\n              service:\n                name: domain-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /procurement\n            backend:\n              service:\n                name: procurement-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /item\n            backend:\n              service:\n                name: item-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /partner\n            backend:\n              service:\n                name: partner-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /wms\n            backend:\n              service:\n                name: wms-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /mes\n            backend:\n              service:\n                name: mes-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /tms\n            backend:\n              service:\n                name: tms-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /oms\n            backend:\n              service:\n                name: oms-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /pms\n            backend:\n              service:\n                name: pms-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /fino\n            backend:\n              service:\n                name: finance-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /vat\n            backend:\n              service:\n                name: vat-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /hcm\n            backend:\n              service:\n                name: hcm-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /asset\n            backend:\n              service:\n                name: asset-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /rtm\n            backend:\n              service:\n                name: rtm-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /identity\n            backend:\n              service:\n                name: ibos-identity-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /imp\n            backend:\n              service:\n                name: import-api\n                port:\n                  number: 80\n          - pathType: Prefix\n            path: /arlerp\n            backend:\n              service:\n                name: arlerp-api\n                port:\n                  number: 80\n\n  tls:\n    - hosts:\n        - dev-madina.ibos.io\n        - dev-madina-socket.ibos.io\n        - dev-shipping.ibos.io\n        - dev-uat-madina.ibos.io\n        - dev-uat-madina-socket.ibos.io\n        - dev-apon.ibos.io\n        - dev-vat.ibos.io\n        - dev-arlvat.ibos.io\n        - dev-mgm.ibos.io\n        - dev-mgm-socket.ibos.io\n        - dev-panel.ibos.io\n        - dev-dealer.ibos.io\n        - dev-erp.ibos.io\n        - dev-rtm.ibos.io\n        - dev-auth.ibos.io\n        - dev-signal.ibos.io\n        - dev-rmg.ibos.io\n        - dev-rmghr.ibos.io\n        - dev-primevat.ibos.io\n        - dev-sscorporation.ibos.io\n        - dev-mgm-socket.ibos.io\n        - dev-promotion.ibos.io\n\n      secretName: ibosio-ingress-tls\n\n      #peopledesk\n    - hosts:\n        - dev-uttara.peopledesk.io\n        - dev-hr.peopledesk.io\n        - dev-ibos.peopledesk.io\n        - dev-hire.peopledesk.io\n        - dev-rsc.peopledesk.io\n        - dev-arl.peopledesk.io\n        - dev-ifarmer.peopledesk.io\n        - dev-justiceandcarebd.peopledesk.io\n\n      secretName: peopledesk-ingress-tls\n\n      #akijresources\n    - hosts:\n        - dev-erp.akijresources.com\n\n      secretName: akijresources-ingress-tls' >> ibos_ingress.yaml
chmod +x ibos_ingress.yaml
kubectl -n production apply -f ibos_ingress.yaml

kubectl -n production create secret docker-registry dockercred --docker-server=https://index.docker.io --docker-username=iboslimitedbd --docker-password=iBOS@ltd21 --docker-email=iboslimitedbd@gmail.com


rm ~/.bash_history
history -c

rm run.sh

rm ~/.bash_history
history -c

reboot
